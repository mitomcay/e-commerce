<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title><%= productDetail.ProductName %></title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free HTML Templates" name="keywords">
    <meta content="Free HTML Templates" name="description">

    <!-- Favicon -->
    <link href="/img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">  

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="/lib/animate/animate.min.css" rel="stylesheet">
    <link href="/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="/css/style.css" rel="stylesheet">
    <style>
        /* Style cho kết quả tìm kiếm */
        #search-result {
            margin-top: 10px;
            position: absolute;
            top: 100%;
            width: 100%;
            max-height: 300px;
            overflow-y: auto;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 10;
            display: none; /* Ẩn kết quả tìm kiếm khi chưa có từ khóa */
        }

        /* Hiển thị kết quả tìm kiếm khi có sản phẩm */
        #search-result.active {
            display: block;
        }

        /* Style cho từng item trong kết quả tìm kiếm */
        .search-item {
            padding: 10px;
            border-bottom: 1px solid #f1f1f1;
            transition: background-color 0.3s ease;
        }

        .search-item:hover {
            background-color: #f5f5f5;
        }

        .search-item img {
            width: 50px;
            height: 50px;
            object-fit: cover;
            margin-right: 10px;
        }

        .search-item .btn {
            text-decoration: none;
            color: #007bff;
        }

        .search-item .btn:hover {
            color: #0056b3;
        }

        /* Style cho thông báo không có kết quả */
        #search-result p {
            padding: 10px;
            font-size: 14px;
            color: #666;
        }

    </style>
</head>

<body>
    <!-- Topbar Start -->
    <div class="container-fluid">
        <div class="row bg-secondary py-1 px-xl-5">
            <div class="col-lg-6 d-none d-lg-block">
                <div class="d-inline-flex align-items-center h-100">
                    <a class="text-body mr-3" href="">About</a>
                    <a class="text-body mr-3" href="">Contact</a>
                    <a class="text-body mr-3" href="">Help</a>
                    <a class="text-body mr-3" href="">FAQs</a>
                </div>
            </div>
            <div class="col-lg-6 text-center text-lg-right">
                <div class="d-inline-flex align-items-center">
                    <div class="btn-group">
                        <% if(isLoggedIn) {%>
                            <button type="button" class="btn btn-sm btn-light dropdown-toggle" data-toggle="dropdown"><img src="/uploads/<%= user.ImageUrl %>" class="avatar-xl border-radius" width="20"></button>
                            <div class="dropdown-menu dropdown-menu-right">
                                <a class="dropdown-item btn btn-primary active" href="#"> Hi <%= user.firstName %></a>
                                <a class="dropdown-item btn btn-primary" href="/profile"><i class="fas fa-user"></i> Profile</a>
                                <% if(user.Role == "Admin") {%>
                                    <a class="dropdown-item btn btn-primary" href="/admin"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
                                <% } %> 
                                <a class="dropdown-item btn btn-primary" href="/logout">Logout</a>
                            </div>
                        <% } else {%>
                            <button type="button" class="btn btn-sm btn-light dropdown-toggle" data-toggle="dropdown"><i class="fas fa-user"></i></button>
                            <div class="dropdown-menu dropdown-menu-right">
                                <a class="dropdown-item btn btn-primary" href="/login">Sign in</a>
                                <a class="dropdown-item btn btn-primary" href="/register">Sign up</a>
                            </div>
                        <% } %>
                    </div>
                    <div class="btn-group mx-2">
                        <button type="button" class="btn btn-sm btn-light dropdown-toggle" data-toggle="dropdown">USD</button>
                        <div class="dropdown-menu dropdown-menu-right">
                            <button class="dropdown-item" type="button">EUR</button>
                            <button class="dropdown-item" type="button">GBP</button>
                            <button class="dropdown-item" type="button">CAD</button>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button type="button" class="btn btn-sm btn-light dropdown-toggle" data-toggle="dropdown">EN</button>
                        <div class="dropdown-menu dropdown-menu-right">
                            <button class="dropdown-item" type="button">FR</button>
                            <button class="dropdown-item" type="button">AR</button>
                            <button class="dropdown-item" type="button">RU</button>
                        </div>
                    </div>
                </div>
                <div class="d-inline-flex align-items-center d-block d-lg-none">
                    <a href="/likes" class="btn px-0 ml-2">
                        <i class="fas fa-heart text-dark"></i>
                        <span class="badge text-dark border border-dark rounded-circle like-count" style="padding-bottom: 2px;">0</span>
                    </a>
                    <a href="/carts" class="btn px-0 ml-2">
                        <i class="fas fa-shopping-cart text-dark"></i>
                        <span class="badge text-dark border border-dark rounded-circle cart-count" style="padding-bottom: 2px;">0</span>
                    </a>
                </div>
            </div>
        </div>
        <div class="row align-items-center bg-light py-3 px-xl-5 d-none d-lg-flex">
            <div class="col-lg-4">
                <a href="/" class="text-decoration-none">
                    <span class="h1 text-uppercase text-primary bg-dark px-2">Multi</span>
                    <span class="h1 text-uppercase text-dark bg-primary px-2 ml-n1">Shop</span>
                </a>
            </div>
            <div class="col-lg-4 col-6 text-left">
                <form action="/chatbot-search" method="GET">
                    <div class="input-group">
                        <input type="text" class="form-control" id="search" name="keywords" placeholder="Search for products">
                        <div class="input-group-append">
                            <button type="submit" class="input-group-text bg-transparent text-primary">
                                <i class="fa fa-search"></i>
                            </button>
                        </div>
                    </div>
                    <div id="search-result">

                    </div>
                </form>
            </div>
            <div class="col-lg-4 col-6 text-right">
                <p class="m-0">Customer Service</p>
                <h5 class="m-0">+012 345 6789</h5>
            </div>
        </div>
    </div>
    <!-- Topbar End -->


    <!-- Navbar Start -->
    <div class="container-fluid bg-dark mb-30">
        <div class="row px-xl-5">
            <div class="col-lg-3 d-none d-lg-block">
                <a class="btn d-flex align-items-center justify-content-between bg-primary w-100" data-toggle="collapse" href="#navbar-vertical" style="height: 65px; padding: 0 30px;">
                    <h6 class="text-dark m-0"><i class="fa fa-bars mr-2"></i>Categories</h6>
                    <i class="fa fa-angle-down text-dark"></i>
                </a>
                <nav class="collapse position-absolute navbar navbar-vertical navbar-light align-items-start p-0 bg-light" id="navbar-vertical" style="width: calc(100% - 30px); z-index: 999;">
                    <div class="navbar-nav w-100">
                        <div class="nav-item dropdown dropright">
                            <a href="/category/10" class="nav-link dropdown-toggle" data-toggle="dropdown">Dresses <i class="fa fa-angle-right float-right mt-1"></i></a>
                            <div class="dropdown-menu position-absolute rounded-0 border-0 m-0">
                                <a href="/category/1" class="dropdown-item">Men's Dresses</a>
                                <a href="/category/2" class="dropdown-item">Women's Dresses</a>
                                <a href="/category/3" class="dropdown-item">Baby's Dresses</a>
                            </div>
                        </div>
                        <a href="/category/4" class="nav-item nav-link">Shirts</a>
                        <a href="/category/5" class="nav-item nav-link">Jeans</a>
                        <a href="/category/6" class="nav-item nav-link">Swimwear</a>
                        <a href="/category/7" class="nav-item nav-link">Sleepwear</a>
                        <a href="/category/8" class="nav-item nav-link">Sportswear</a>
                        <a href="/category/9" class="nav-item nav-link">Jumpsuits</a>
                        <a href="/category/10" class="nav-item nav-link">Blazers</a>
                        <a href="/category/11" class="nav-item nav-link">Jackets</a>
                        <a href="/category/12" class="nav-item nav-link">Shoes</a>
                    </div>
                </nav>
            </div>
            <div class="col-lg-9">
                <nav class="navbar navbar-expand-lg bg-dark navbar-dark py-3 py-lg-0 px-0">
                    <a href="" class="text-decoration-none d-block d-lg-none">
                        <span class="h1 text-uppercase text-dark bg-light px-2">Multi</span>
                        <span class="h1 text-uppercase text-light bg-primary px-2 ml-n1">Shop</span>
                    </a>
                    <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
                        <div class="navbar-nav mr-auto py-0">
                            <a href="/" class="nav-item nav-link">Home</a>
                            <a href="/shop" class="nav-item nav-link">Shop</a>
                            <!-- <a href="detail.html" class="nav-item nav-link active">Shop Detail</a> -->
                            <div class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Pages <i class="fa fa-angle-down mt-1"></i></a>
                                <div class="dropdown-menu bg-primary rounded-0 border-0 m-0">
                                    <a href="/carts" class="dropdown-item">Shopping Cart</a>
                                    <a href="/checkout" class="dropdown-item">Checkout</a>
                                </div>
                            </div>
                            <a href="/contact" class="nav-item nav-link">Contact</a>
                        </div>
                        <div class="navbar-nav ml-auto py-0 d-none d-lg-block">
                            <a href="/likes" class="btn px-0">
                                <i class="fas fa-heart text-primary"></i>
                                <span class="badge text-secondary border border-secondary rounded-circle like-count" style="padding-bottom: 2px;">0</span>
                            </a>
                            <a href="/carts" class="btn px-0 ml-3">
                                <i class="fas fa-shopping-cart text-primary"></i>
                                <span class="badge text-secondary border border-secondary rounded-circle cart-count" style="padding-bottom: 2px;">0</span>
                            </a>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
    </div>
    <!-- Navbar End -->


    <!-- Breadcrumb Start -->
    <div class="container-fluid">
        <div class="row px-xl-5">
            <div class="col-12">
                <nav class="breadcrumb bg-light mb-30">
                    <a class="breadcrumb-item text-dark" href="/">Home</a>
                    <a class="breadcrumb-item text-dark" href="/shop">Shop</a>
                    <span class="breadcrumb-item active">Shop Detail</span>
                </nav>
            </div>
        </div>
    </div>
    <!-- Breadcrumb End -->


    <!-- Shop Detail Start -->
    <div class="container-fluid pb-5">
        <div class="row px-xl-5">
            <div class="col-lg-5 mb-30">
                <div id="product-carousel" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner bg-light">
                        <div class="carousel-item active">
                            <img class="w-100 h-100" src="/uploads/<%= productDetail.ImageUrl %>" alt="Image">
                        </div>
                        <div class="carousel-item">
                            <img class="w-100 h-100" src="/uploads/<%= productDetail.ImageUrl %>" alt="Image">
                        </div>
                        <div class="carousel-item">
                            <img class="w-100 h-100" src="/uploads/<%= productDetail.ImageUrl %>" alt="Image">
                        </div>
                        <div class="carousel-item">
                            <img class="w-100 h-100" src="/uploads/<%= productDetail.ImageUrl %>" alt="Image">
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#product-carousel" data-slide="prev">
                        <i class="fa fa-2x fa-angle-left text-dark"></i>
                    </a>
                    <a class="carousel-control-next" href="#product-carousel" data-slide="next">
                        <i class="fa fa-2x fa-angle-right text-dark"></i>
                    </a>
                </div>
            </div>

            <div class="col-lg-7 h-auto mb-30">
                <div class="h-100 bg-light p-30">
                    <h3><%= productDetail.ProductName %></h3>
                    <div class="d-flex mb-3">
                        <div class="text-primary mr-2">
                            <small class="fas fa-star"></small>
                            <small class="fas fa-star"></small>
                            <small class="fas fa-star"></small>
                            <small class="fas fa-star-half-alt"></small>
                            <small class="far fa-star"></small>
                        </div>
                        <small class="pt-1">(99 Reviews)</small>
                    </div>
                    <h3 class="font-weight-semi-bold mb-4">$<%= productDetail.Price %></h3>
                    <p class="mb-4"><%= productDetail.Description %></p>
                    <div class="d-flex mb-3">
                        <strong class="text-dark mr-3">Sizes:</strong>
                        <form>
                            <% productDetail.Size.forEach((size, i) => { %>
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input type="radio" class="custom-control-input" id="size-<%= i %>" name="size" value="<%= size %>">
                                    <label class="custom-control-label" for="size-<%= i %>"><%= size %></label>
                                </div>
                            <% }) %>
                            
                            <!-- <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="size-2" name="size">
                                <label class="custom-control-label" for="size-2">S</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="size-3" name="size">
                                <label class="custom-control-label" for="size-3">M</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="size-4" name="size">
                                <label class="custom-control-label" for="size-4">L</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="size-5" name="size">
                                <label class="custom-control-label" for="size-5">XL</label>
                            </div> -->
                        </form>
                    </div>
                    <div class="d-flex mb-4">
                        <strong class="text-dark mr-3">Colors:</strong>
                        <form>
                            <% productDetail.Color.forEach((color, i) => { %>
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input type="radio" class="custom-control-input" id="color-<%= i %>" name="color" value="<%= color %>">
                                    <label class="custom-control-label" for="color-<%= i %>"><%= color %></label>
                                </div>
                            <% }) %>
                            <!-- <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="color-1" name="color">
                                <label class="custom-control-label" for="color-1">Black</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="color-2" name="color">
                                <label class="custom-control-label" for="color-2">White</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="color-3" name="color">
                                <label class="custom-control-label" for="color-3">Red</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="color-4" name="color">
                                <label class="custom-control-label" for="color-4">Blue</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="color-5" name="color">
                                <label class="custom-control-label" for="color-5">Green</label>
                            </div> -->
                        </form>
                    </div>
                    <div class="d-flex align-items-center mb-4 pt-2">
                        <div class="input-group quantity mr-3" style="width: 130px;">
                            <div class="input-group-btn">
                                <button class="btn btn-primary btn-minus">
                                    <i class="fa fa-minus"></i>
                                </button>
                            </div>
                            <input type="text" class="form-control bg-secondary border-0 text-center" id="count" value="1">
                            <div class="input-group-btn">
                                <button class="btn btn-primary btn-plus">
                                    <i class="fa fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <button class="btn btn-primary px-3" onclick="addtocartwithcount('<%= productDetail.id %>')">
                            <i class="fa fa-shopping-cart mr-1"></i> Add To Cart
                        </button>                        
                    </div>
                    <div class="d-flex pt-2">
                        <strong class="text-dark mr-2">Share on:</strong>
                        <div class="d-inline-flex">
                            <a class="text-dark px-2" href="">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <a class="text-dark px-2" href="">
                                <i class="fab fa-twitter"></i>
                            </a>
                            <a class="text-dark px-2" href="">
                                <i class="fab fa-linkedin-in"></i>
                            </a>
                            <a class="text-dark px-2" href="">
                                <i class="fab fa-pinterest"></i>
                            </a>
                        </div>
                    </div>
                    <div class="d-flex mb-3">
                        <strong class="text-dark mr-3">Tags:</strong>
                        <form>
                            <% productDetail.Tags.forEach(tag => { %>
                                <div class="custom-control custom-control-inline">
                                    <a class="" for="size-1" href="/tag/<%= tag %>"><%= tag %></a>
                                </div>
                            <% }) %>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="row px-xl-5">
            <div class="col">
                <div class="bg-light p-30">
                    <div class="nav nav-tabs mb-4">
                        <a class="nav-item nav-link text-dark active" data-toggle="tab" href="#tab-pane-1">Description</a>
                        <a class="nav-item nav-link text-dark" data-toggle="tab" href="#tab-pane-2">Comments (0)</a>
                        <a class="nav-item nav-link text-dark" data-toggle="tab" href="#tab-pane-3">Leave Comment </a>
                    </div>
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="tab-pane-1">
                            <h4 class="mb-3">Product Description</h4>
                            <p><%= productDetail.Description %></p>
                        </div>
                        <!-- <div class="tab-pane fade" id="tab-pane-2">
                            <h4 class="mb-3">Additional Information</h4>
                            <p>Eos no lorem eirmod diam diam, eos elitr et gubergren diam sea. Consetetur vero aliquyam invidunt duo dolores et duo sit. Vero diam ea vero et dolore rebum, dolor rebum eirmod consetetur invidunt sed sed et, lorem duo et eos elitr, sadipscing kasd ipsum rebum diam. Dolore diam stet rebum sed tempor kasd eirmod. Takimata kasd ipsum accusam sadipscing, eos dolores sit no ut diam consetetur duo justo est, sit sanctus diam tempor aliquyam eirmod nonumy rebum dolor accusam, ipsum kasd eos consetetur at sit rebum, diam kasd invidunt tempor lorem, ipsum lorem elitr sanctus eirmod takimata dolor ea invidunt.</p>
                            <div class="row">
                                <div class="col-md-6">
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item px-0">
                                            Sit erat duo lorem duo ea consetetur, et eirmod takimata.
                                        </li>
                                        <li class="list-group-item px-0">
                                            Amet kasd gubergren sit sanctus et lorem eos sadipscing at.
                                        </li>
                                        <li class="list-group-item px-0">
                                            Duo amet accusam eirmod nonumy stet et et stet eirmod.
                                        </li>
                                        <li class="list-group-item px-0">
                                            Takimata ea clita labore amet ipsum erat justo voluptua. Nonumy.
                                        </li>
                                      </ul> 
                                </div>
                                <div class="col-md-6">
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item px-0">
                                            Sit erat duo lorem duo ea consetetur, et eirmod takimata.
                                        </li>
                                        <li class="list-group-item px-0">
                                            Amet kasd gubergren sit sanctus et lorem eos sadipscing at.
                                        </li>
                                        <li class="list-group-item px-0">
                                            Duo amet accusam eirmod nonumy stet et et stet eirmod.
                                        </li>
                                        <li class="list-group-item px-0">
                                            Takimata ea clita labore amet ipsum erat justo voluptua. Nonumy.
                                        </li>
                                      </ul> 
                                </div>
                            </div>
                        </div> -->
                        <div class="tab-pane fade" id="tab-pane-2">
                            <h4 class="mb-3">Comments</h4>
                            <div id="comment-section" data-product="<%= productDetail.id %>">
                                
                            </div>
                        </div>
                        <div class="tab-pane fade" id="tab-pane-3">
                                <% if(isLoggedIn === true) { %>
                                    <div class="d-flex my-3">
                                        <p class="mb-0 mr-2">Your Rating:</p>
                                        <div class="text-primary" id="rating-stars">
                                            <i class="far fa-star" data-rating="1"></i>
                                            <i class="far fa-star" data-rating="2"></i>
                                            <i class="far fa-star" data-rating="3"></i>
                                            <i class="far fa-star" data-rating="4"></i>
                                            <i class="far fa-star" data-rating="5"></i>
                                        </div>
                                    </div>
                                    <!-- Input ẩn để gửi rating -->
                                    <input type="number" class="d-none" name="rating" id="rating-value" >
                                
                                
                                <div class="form-group">
                                    <label for="message">Your Comment:</label>
                                    <textarea id="message" name="message" cols="30" rows="5" class="form-control" required></textarea>
                                </div>
                                
                                <div class="form-group mb-0">
                                    <button id="btn-comment" class="btn btn-primary px-3">Comment</button>
                                </div>
                                <% } else { %>
                                    <div class="alert alert-info mb-0">Please <a href="/login" class="btn btn-outline-dark">login</a> to leave comment</div>
                                <% } %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Shop Detail End -->


    <!-- Products Start -->
    <div class="container-fluid py-5">
        <h2 class="section-title position-relative text-uppercase mx-xl-5 mb-4"><span class="bg-secondary pr-3">You May Also Like</span></h2>
        <div class="row px-xl-5">
            <div class="col">
                <div class="owl-carousel related-carousel d-flex justify-content-between" id="random4product">
                    
                </div>
            </div>
        </div>
    </div>
    <!-- Products End -->


    <!-- Footer Start -->
    <div class="container-fluid bg-dark text-secondary mt-5 pt-5">
        <div class="row px-xl-5 pt-5">
            <div class="col-lg-4 col-md-12 mb-5 pr-3 pr-xl-5">
                <h5 class="text-secondary text-uppercase mb-4">Get In Touch</h5>
                <p class="mb-4">No dolore ipsum accusam no lorem. Invidunt sed clita kasd clita et et dolor sed dolor. Rebum tempor no vero est magna amet no</p>
                <p class="mb-2"><i class="fa fa-map-marker-alt text-primary mr-3"></i>123 Street, New York, USA</p>
                <p class="mb-2"><i class="fa fa-envelope text-primary mr-3"></i>info@example.com</p>
                <p class="mb-0"><i class="fa fa-phone-alt text-primary mr-3"></i>+012 345 67890</p>
            </div>
            <div class="col-lg-8 col-md-12">
                <div class="row">
                    <div class="col-md-4 mb-5">
                        <h5 class="text-secondary text-uppercase mb-4">Quick Shop</h5>
                        <div class="d-flex flex-column justify-content-start">
                            <a class="text-secondary mb-2" href="/"><i class="fa fa-angle-right mr-2"></i>Home</a>
                            <a class="text-secondary mb-2" href="/shop"><i class="fa fa-angle-right mr-2"></i>Our Shop</a>
                            <!-- <a class="text-secondary mb-2" href="#"><i class="fa fa-angle-right mr-2"></i>Shop Detail</a> -->
                            <a class="text-secondary mb-2" href="/carts"><i class="fa fa-angle-right mr-2"></i>Shopping Cart</a>
                            <a class="text-secondary mb-2" href="/checkout"><i class="fa fa-angle-right mr-2"></i>Checkout</a>
                            <a class="text-secondary" href="#"><i class="fa fa-angle-right mr-2"></i>Contact Us</a>
                        </div>
                    </div>
                    <div class="col-md-4 mb-5">
                        <h5 class="text-secondary text-uppercase mb-4">My Account</h5>
                        <div class="d-flex flex-column justify-content-start">
                            <a class="text-secondary mb-2" href="/"><i class="fa fa-angle-right mr-2"></i>Home</a>
                            <a class="text-secondary mb-2" href="/shop"><i class="fa fa-angle-right mr-2"></i>Our Shop</a>
                            <!-- <a class="text-secondary mb-2" href="#"><i class="fa fa-angle-right mr-2"></i>Shop Detail</a> -->
                            <a class="text-secondary mb-2" href="/carts"><i class="fa fa-angle-right mr-2"></i>Shopping Cart</a>
                            <a class="text-secondary mb-2" href="/checkout"><i class="fa fa-angle-right mr-2"></i>Checkout</a>
                            <a class="text-secondary" href="#"><i class="fa fa-angle-right mr-2"></i>Contact Us</a>
                        </div>
                    </div>
                    <div class="col-md-4 mb-5">
                        <h5 class="text-secondary text-uppercase mb-4">Newsletter</h5>
                        <p>Duo stet tempor ipsum sit amet magna ipsum tempor est</p>
                        <form action="">
                            <div class="input-group">
                                <input type="text" class="form-control" placeholder="Your Email Address">
                                <div class="input-group-append">
                                    <button class="btn btn-primary">Sign Up</button>
                                </div>
                            </div>
                        </form>
                        <h6 class="text-secondary text-uppercase mt-4 mb-3">Follow Us</h6>
                        <div class="d-flex">
                            <a class="btn btn-primary btn-square mr-2" href="#"><i class="fab fa-twitter"></i></a>
                            <a class="btn btn-primary btn-square mr-2" href="#"><i class="fab fa-facebook-f"></i></a>
                            <a class="btn btn-primary btn-square mr-2" href="#"><i class="fab fa-linkedin-in"></i></a>
                            <a class="btn btn-primary btn-square" href="#"><i class="fab fa-instagram"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row border-top mx-xl-5 py-4" style="border-color: rgba(256, 256, 256, .1) !important;">
            <div class="col-md-6 px-xl-0">
                <p class="mb-md-0 text-center text-md-left text-secondary">
                    &copy; <a class="text-primary" href="#">Domain</a>. All Rights Reserved. Designed
                    by
                    <a class="text-primary" href="/">HTML Codex</a>
                </p>
            </div>
            <div class="col-md-6 px-xl-0 text-center text-md-right">
                <img class="img-fluid" src="/img/payments.png" alt="">
            </div>
        </div>
    </div>
    <!-- Footer End -->

    <!-- chat-box -->
    <%- include('./shoppartial/chatbot.ejs') %>

    <!-- Back to Top -->
    <a href="#" class="btn btn-primary back-to-top"><i class="fa fa-angle-double-up"></i></a>


    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="/lib/easing/easing.min.js"></script>
    <script src="/lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Contact Javascript File -->
    <script src="/mail/jqBootstrapValidation.min.js"></script>
    <script src="/mail/contact.js"></script>

    <!-- Template Javascript -->
    <script src="/js/main.js"></script>

    <script>
        const addtocartwithcount = (id) => {
            let count = $('#count').val();
            let size = $('input[name="size"]:checked').val();
            let color = $('input[name="color"]:checked').val();
            if (!size || !color) {
                alert('Please select size and color'); 
                return;
            }

            // console.log(count, size, color);

            $.ajax({
                url: `/add-to-carts-with-count/${id}`,
                type: 'POST',
                data: {
                    count: count,
                    size: size,
                    color: color
                },
                success: (response) => {
                    alert(response.message);
                },
                error: (error) => {
                    console.error(error);
                }
            });
        }

        $(document).ready( () => {
            const $stars = $("#rating-stars i");
            const $ratingInput = $("#rating-value");

            $stars.click(function () {
                const rating = $(this).data("rating");
                $ratingInput.val(rating); // Lưu rating vào input ẩn
                console.log(rating);
                // Đổi màu sao
                $stars.removeClass("fas");
                $stars.slice(0, rating).addClass("fas");
            });

            $.ajax({
                url: '/getrandom4Product',
                type: 'GET',
                success: (response) => {
                    let productHtml = '';
                    response.products.forEach(product => {
                        productHtml += `<div class="product-item bg-light">
                                            <div class="product-img position-relative overflow-hidden">
                                                <img class="img-fluid w-100" src="/uploads/${product.ImageUrl}" alt="${product.ImageUrl}">
                                                <div class="product-action">
                                                    <button class="btn btn-outline-dark btn-square" onclick="addtocart(${product.id})"><i class="fa fa-shopping-cart"></i></button>
                                                    <button class="btn btn-outline-dark btn-square" onclick="addtowishlist(${product.id})"><i class="far fa-heart"></i></button>
                                                    <a class="btn btn-outline-dark btn-square" href=""><i class="fa fa-sync-alt"></i></a>
                                                    <a class="btn btn-outline-dark btn-square" href="/productDetail/${product.id}"><i class="fa fa-search"></i></a>
                                                </div>
                                            </div>
                                            <div class="text-center py-4">
                                                <a class="h6 text-decoration-none text-truncate" href="/productDetail/${product.id}">${product.ProductName}</a>
                                                <div class="d-flex align-items-center justify-content-center mt-2">
                                                    <h5>$${product.Price - product.Price * (product.Discount/100)}</h5><h6 class="text-muted ml-2"><del>$${product.Price}</del></h6>
                                                </div>
                                                <div class="d-flex align-items-center justify-content-center mb-1">
                                                    <small class="fa fa-star text-primary mr-1"></small>
                                                    <small class="fa fa-star text-primary mr-1"></small>
                                                    <small class="fa fa-star text-primary mr-1"></small>
                                                    <small class="fa fa-star text-primary mr-1"></small>
                                                    <small class="fa fa-star text-primary mr-1"></small>
                                                    <small>(99)</small>
                                                </div>
                                            </div>
                                        </div>`;
                    });
                    $('#random4product').html(productHtml);
                }
            });



            $.ajax({
                url: `/cart-count`,
                type: 'GET',
                success: (response) => {
                    $('.cart-count').text(response.totalItems);
                }
            });

            $.ajax({
                url: `/wishlist-count`,
                type: 'GET',
                success: (response) => {
                    $('.like-count').text(response.totalItems);
                }
            });
        });

        $(document).ready(() => {
            const productid = $("#comment-section").data("product"); // Lấy ID sản phẩm từ thuộc tính data
            $.ajax({
                url: `/getcomments/${productid}`,
                type: 'GET',
                success: (response) => {
                    let commentHtml = '';
                    const userCookie = getCookie('userid');
                    // console.log(userCookie);
                    
                    response.comment.forEach(cm => {
                        let ratingHtml = '';
                        const rating = cm.rating ? cm.rating : 0;
                
                        for (let i = 1; i <= 5; i++) {
                            if (i <= rating) {
                                ratingHtml += `<i class="fas fa-star text-warning"></i>`; 
                            } else {
                                ratingHtml += `<i class="far fa-star text-secondary"></i>`; 
                            }
                        }
                        let btndelete = userCookie == cm.user?.id ? `<button class="btn btn-outline-primary btn-sm float-right delete-comment" onclick="DeleteComment('${cm.id}')" data-id="${cm.id}">Delete</button>` : '';
                        commentHtml += `
                            <div class="media mb-4">
                                <img class="d-flex mr-3 rounded-circle border-radius avatar-xl" src="/uploads/${cm.user?.ImageUrl}" alt="${cm.user?.ImageUrl}" width="30">
                                <div class="media-body">
                                    <h5 class="mt-0 mb-1">${cm.user?.firstName} - ${ratingHtml}</h5> 
                                    <p>${cm.comment}</p>
                                    <small class="text-muted">${cm.createdAt}</small>
                                    ${btndelete}
                                </div>
                            </div>
                        `;
                    });
                    $('#comment-section').html(commentHtml);
                },
                error: (xhr, status, error) => {
                    console.error("Error fetching comments:", error);
                }
            });
        });


        $('#btn-comment').click( () => {
            const productid = $("#comment-section").data("product");
            const comment = $('#message').val();
            const rating = $('#rating-value').val();
            if(!rating || !comment) {
                alert('Please enter comment and rating');
                return;
            }

            console.log(productid, rating, comment);
            $.ajax({
                url: `/Comment/${productid}`,
                method: 'POST',
                data: {
                    productId: productid,
                    comment: comment,
                    rating: rating
                },
                success: (response) => {
                    alert(response.message);
                    location.reload();
                },
                error: (xhr, status, error) => {
                    console.error("Error adding comment:", error);
                }
            });
        });

        const addtocart = (id) =>{
            $.ajax({
                url: `/add-to-carts/${id}`,
                method: 'POST',
                success: (response) => {
                    alert(response.message);
                    return ;
                }
            })
        }

        const DeleteComment = (id) => {
            $.ajax({
                url: `/delete-comment/${id}`,
                method: 'POST',
                success: (response) => {
                    alert(response.message);
                    location.reload();
                }
            })
        }

        $('#search').on('input', () => {
            let keyword = $('#search').val();

            if (keyword) {
                $.ajax({
                    url: `/search-products/${keyword}`,
                    method: 'GET',
                    success: (response) => {
                        let html = '';

                        if (response.products && response.products.length > 0) {
                            response.products.forEach(product => {
                                html += `
                                    <div class="search-item card">
                                        <div style="display: flex;">
                                            <img class="avatar-xl" src="/uploads/${product.ImageUrl ? product.ImageUrl : 'default-image.png'}" alt="${product.ProductName}">
                                            <a class="btn btn-outline-dark" href="/productDetail/${product.id}">${product.ProductName}</a>
                                        </div>
                                        <p>${product.Description}</p>
                                    </div>
                                `;
                            });
                        } else {
                            html = '<p>No products found</p>';
                        }

                        // Hiển thị kết quả tìm kiếm trong #search-result
                        $('#search-result').html(html).addClass('active');
                    },
                    error: (err) => {
                        console.error('Search request failed:', err);
                        $('#search-result').html('<p>Error occurred during search.</p>').addClass('active');
                    }
                });
            } else {
                // Nếu không có từ khóa, xóa kết quả tìm kiếm
                $('#search-result').removeClass('active').html('');
            }
        });

        const addtowishlist = (id) =>{
            $.ajax({
                url: `/add-to-wishlist/${id}`,
                method: 'POST',
                success: (response) => {
                    alert(response.message);
                    window.location.reload();
                }
            })
        }

        function getCookie(name) {
            const cookies = document.cookie.split('; ');
            for (let i = 0; i < cookies.length; i++) {
                const [key, value] = cookies[i].split('=');
                if (key === name) {
                return decodeURIComponent(value);
                }
            }
            return null;
        }
    </script>
</body>

</html>